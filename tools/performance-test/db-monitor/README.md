# DB ì•Œë¦¼ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ

**íƒ€ê²Ÿ í”„ë¡œì íŠ¸ ì½”ë“œ ìˆ˜ì • ì—†ì´ ì™¸ë¶€ì—ì„œ ë…ë¦½ ì‹¤í–‰ë˜ëŠ” MSSQL ëª¨ë‹ˆí„°ë§ ë„êµ¬**

---

## ğŸ“Œ í•µì‹¬ íŠ¹ì§•

- âœ… **ì™¸ë¶€ ë…ë¦½ ì‹¤í–‰** - íƒ€ê²Ÿ í”„ë¡œì íŠ¸(SDMS, AutoCRM) ì½”ë“œ ìˆ˜ì • ë¶ˆí•„ìš”
- âœ… **ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰** - UI ì—†ì´ ì™„ì „ ë…ë¦½ ì‹¤í–‰
- âœ… **ì‹¤ì‹œê°„ ê°ì§€** - ëŠë¦° ì¿¼ë¦¬, ì°¨ë‹¨, ë†’ì€ CPU, ë°ë“œë½
- âœ… **ìë™ ì•Œë¦¼** - ë¡œê·¸ ì €ì¥ + ì´ë©”ì¼ ë°œì†¡
- âœ… **AI ë¶ˆí•„ìš”** - ë‹¨ìˆœ ì„¤ì •ë§Œìœ¼ë¡œ ë™ì‘

---

## ğŸš€ ë¹ ë¥¸ ì‹œì‘ (3ë¶„)

### 1. ì„¤ì¹˜

```bash
cd tools/performance-test
npm install
```

### 2. ì„¤ì •

`db-monitor/config/alert-config.json` í¸ì§‘:

```json
{
  "email": {
    "smtp": {
      "auth": {
        "user": "your-email@gmail.com",
        "pass": "your-app-password"
      }
    },
    "to": ["dba@company.com"]
  }
}
```

### 3. ì‹¤í–‰

```bash
# í„°ë¯¸ë„ì—ì„œ ì‹¤í–‰
npm run monitor

# ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰
nohup npm run monitor > monitor.log 2>&1 &
```

---

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ íƒ€ê²Ÿ í”„ë¡œì íŠ¸    â”‚  â† ì½”ë“œ ìˆ˜ì • ë¶ˆí•„ìš”!
â”‚   (SDMS/BPS)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MSSQL DB      â”‚  â† DMVë¡œ ëª¨ë‹ˆí„°ë§
â”‚ 211.217.11.5    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ db-alert-       â”‚  â† ì™¸ë¶€ ë…ë¦½ ì‹¤í–‰
â”‚ monitor.js      â”‚     (ai-coding-rules/tools)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â†“         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚ ë¡œê·¸   â”‚ â”‚ì´ë©”ì¼â”‚
â”‚ íŒŒì¼   â”‚ â”‚ ì•Œë¦¼ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜
```

**í•µì‹¬**: MSSQLì˜ DMV(Dynamic Management Views)ë¥¼ ì¿¼ë¦¬í•˜ì—¬ ê°ì‹œ
- `sys.dm_exec_requests` - ì‹¤í–‰ ì¤‘ì¸ ì¿¼ë¦¬
- `sys.dm_exec_query_stats` - ì¿¼ë¦¬ í†µê³„
- `sys.dm_tran_locks` - ë½ ì •ë³´

---

## ğŸ“Š ê°ì§€ í•­ëª©

| í•­ëª© | ì„¤ëª… | ì„ê³„ê°’ |
|------|------|--------|
| ëŠë¦° ì¿¼ë¦¬ | ì‹¤í–‰ ì‹œê°„ ì´ˆê³¼ | 3ì´ˆ/1ì´ˆ/0.5ì´ˆ |
| ì°¨ë‹¨(Blocking) | ì„¸ì…˜ì´ ë‹¤ë¥¸ ì„¸ì…˜ì„ ì°¨ë‹¨ | 5ì´ˆ/1ì´ˆ/0.5ì´ˆ |
| ë†’ì€ CPU | CPU ì‚¬ìš©ëŸ‰ ì´ˆê³¼ | 2ì´ˆ/0.5ì´ˆ/0.3ì´ˆ |
| Table Scan | ì¸ë±ìŠ¤ ë¯¸ì‚¬ìš© | ê°ì§€ ì¦‰ì‹œ |
| ë°ë“œë½ | êµì°© ìƒíƒœ | ê°ì§€ ì¦‰ì‹œ |

---

## ğŸ“§ ì•Œë¦¼ ì˜ˆì‹œ

**ì´ë©”ì¼ ì œëª©**: `ğŸš¨ [CRITICAL] DB Alert - SLOW QUERY`

**ë‚´ìš©**:
- ë°œìƒ ì‹œê°, ì„¸ì…˜ ID, ë°ì´í„°ë² ì´ìŠ¤
- ì‹¤í–‰ ì‹œê°„, CPU ì‹œê°„, ë…¼ë¦¬ì  ì½ê¸°
- ì¿¼ë¦¬ í…ìŠ¤íŠ¸
- ì‹¤í–‰ ê³„íš (Table Scan/Index Scan/Index Seek)
- **ê¶Œì¥ ì¡°ì¹˜** (ìë™ ìƒì„±)

**ë¡œê·¸ íŒŒì¼**: `logs/db-alert-2026-01-16.json`

---

## ğŸ“š ìƒì„¸ ë¬¸ì„œ

| ë¬¸ì„œ | ë‚´ìš© |
|------|------|
| [QUICKSTART.md](QUICKSTART.md) | 3ë¶„ ë¹ ë¥¸ ì‹œì‘ |
| [ARCHITECTURE.md](ARCHITECTURE.md) | ì•„í‚¤í…ì²˜ ë° ì™¸ë¶€ ì‹¤í–‰ ìƒì„¸ |
| [CONFIG.md](CONFIG.md) | ì„¤ì • íŒŒì¼ ì™„ë²½ ê°€ì´ë“œ |
| [EMAIL_SETUP.md](EMAIL_SETUP.md) | ì´ë©”ì¼ ì„¤ì • (Gmail/Outlook ë“±) |
| [MONITORING.md](MONITORING.md) | ëª¨ë‹ˆí„°ë§ í•­ëª© ìƒì„¸ |
| [TROUBLESHOOTING.md](TROUBLESHOOTING.md) | ë¬¸ì œ í•´ê²° |
| [ADVANCED.md](ADVANCED.md) | ê³ ê¸‰ ì‚¬ìš©ë²• |

---

## âš™ï¸ í™˜ê²½ë³€ìˆ˜ (ì„ íƒì‚¬í•­)

```bash
export DB_USER="sa"
export DB_PASSWORD="your_password"
export DB_SERVER="211.217.11.5"
export DB_NAME="AutoCRM_Samchully"
```

ì„¤ì •í•˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ê°’ ì‚¬ìš©.

---

## ğŸ›‘ ì¤‘ìš”: AI í•„ìš” ì—†ìŒ

ì´ ë„êµ¬ëŠ” **AI ì—†ì´ ë‹¨ìˆœ ì„¤ì •ë§Œìœ¼ë¡œ ë™ì‘**í•©ë‹ˆë‹¤:
- DB ì—°ê²° ì •ë³´ë§Œ ì…ë ¥
- ì„ê³„ê°’ ì„¤ì • (ì´ˆ ë‹¨ìœ„)
- SMTP ì •ë³´ ì…ë ¥

**ë³µì¡í•œ AI ë¶„ì„ì´ë‚˜ í•™ìŠµ ë¶ˆí•„ìš”!**

---

## ğŸ“ í˜„ì¬ ì œí•œì‚¬í•­

1. âŒ **íŠ¹ì • ì¿¼ë¦¬ë§Œ ì§€ì • ëª¨ë‹ˆí„°ë§ ë¶ˆê°€**
   - ì˜ˆ: "StockManagerImpl.xmlì˜ listStockë§Œ ê°ì‹œ"
   - í˜„ì¬ëŠ” ëª¨ë“  ëŠë¦° ì¿¼ë¦¬ë¥¼ ê°ì§€
   - â†’ ê°œì„  ì˜ˆì •

2. âš ï¸ **Lock ìƒì„¸ ì •ë³´ ë¶€ì¡±**
   - Blocking(ì°¨ë‹¨)ì€ ê°ì§€
   - Lock íƒ€ì…, í…Œì´ë¸” ìƒì„¸ëŠ” ë¶€ì¡±
   - â†’ ê°œì„  ì˜ˆì •

---

## ğŸ”œ ë‹¤ìŒ ë‹¨ê³„

1. [QUICKSTART.md](QUICKSTART.md) ì½ê³  3ë¶„ ì•ˆì— ì‹œì‘
2. [CONFIG.md](CONFIG.md)ì—ì„œ ì„ê³„ê°’ ì¡°ì •
3. ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰:
   ```bash
   nohup npm run monitor > monitor.log 2>&1 &
   ```
4. ë¡œê·¸ í™•ì¸:
   ```bash
   tail -f db-monitor/logs/db-alert-$(date +%Y-%m-%d).json
   ```

---

**ë²„ì „**: 1.0
**ì‘ì„±ì¼**: 2026-01-16
**ë¬¸ì˜**: GitHub Issues
