# DB 분석 도구 설계 검토서

## 1. 총평
**[승인]**
제안된 접근 방식은 실용적이며, 현재 정적 분석의 한계를 효과적으로 보완할 수 있는 설계입니다. 라이브 DB 연결을 통한 스키마 추출은 가장 정확한 메타데이터를 확보할 수 있는 방법입니다.

## 2. 세부 검토 의견

### 2.1 접근 방식 (적절성)
- **타당함**: 정적 분석(코드 파싱)만으로는 동적으로 생성되거나, 외부에서 관리되는 DB 스키마를 파악하기 어렵습니다. `information_schema` 등을 직접 조회하는 방식이 가장 확실합니다.
- **보완 제안**: 분석 대상 DB가 로컬이 아닌 운영/개발 서버일 경우, 네트워크 접근성(VPN, 방화벽) 확인 절차가 문서에 포함되어야 합니다.

### 2.2 기술 스택 (Node.js vs Python)
- **Node.js 선정 동의**: 현재 제안된 Node.js 방식은 I/O 처리에 유리하고 다양한 DB 드라이버(`mysql2`, `pg` 등) 생태계가 잘 갖춰져 있어 적절합니다.
- **대안 비교**: Python(`SQLAlchemy`)은 ORM 레벨에서의 Introspection이 강력하나, 단순히 메타데이터만 추출하는 가벼운 도구로는 Node.js도 충분히 경쟁력이 있습니다. 프로젝트의 기존 스크립트 생태계와 일치한다면 Node.js 진행을 권장합니다.

### 2.3 보안 고려사항
- **.env 필수**: 제안대로 Credentials는 절대 코드에 포함되지 않도록 `.env` 및 환경변수 주입을 강제해야 합니다.
- **최소 권한 원칙**: 문서에 **"DB 분석용 계정은 읽기 전용(SELECT, SHOW VIEW) 권한만 부여할 것"**이라는 권고 사항을 추가해야 합니다.
- **데이터 조회 주의**: '공통코드 테이블 값' 조회 기능은 민감 데이터 유출 위험이 있으므로, 기본적으로는 비활성화(Disabled by default)하고 명시적인 옵션(예: `--dump-data`)이 있을 때만 수행하도록 제한해야 합니다.

### 2.4 구현 및 기능
- **표준화된 Output**: `output/schema.json`의 포맷을 미리 정의해야 합니다. (예: Prisma Schema나 TypeORM Entity 구조와 유사하게 잡으면 추후 코드 생성 등에 활용하기 좋습니다.)
- **우선순위 제안**:
    1. **Core**: 연결 테스트 및 기본 테이블/컬럼 목록 추출 (MySQL/PostgreSQL)
    2. **Relation**: PK/FK 관계 매핑
    3. **Driver**: Oracle/MSSQL 등 엔터프라이즈 DB 지원 확장
    4. **Advanced**: 인덱스 정보 및 View, Stored Procedure 등

### 2.5 DDL 분석 대안
- DDL 파싱은 SQL Dialect가 너무 다양하여 파서 구현 비용이 높습니다. 현재 목표인 "정확한 스키마 파악"을 위해서는 라이브 DB 연결이 훨씬 효율적입니다. DDL 분석은 백업 수단으로 남겨두는 것이 좋습니다.

## 3. 결론 및 승인
제안된 설계를 승인합니다. 단, **보안 섹션에 '읽기 전용 계정 사용 권장' 및 '데이터 추출 옵션화'**를 반영하여 구현을 진행하시기 바랍니다.

---
**검토자**: Gemini CLI
**일자**: 2026-01-14
**판정**: [승인]
