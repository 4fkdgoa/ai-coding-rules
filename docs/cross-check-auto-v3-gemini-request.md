# AI 크로스체크 v3.0 보안 검토 요청 (Gemini)

**검토 대상**: `docs/cross-check-auto-v3-design.md`
**검토 관점**: 보안 취약점 중심
**요청일**: 2026-01-17

---

## 검토 지시사항

**Gemini에게:**

당신은 보안 전문가입니다. 다음 설계 문서를 **공격자 관점**에서 철저히 검토하세요.

### 필수 검토 항목

#### 1. Opus 4.5가 발견한 P0 보안 이슈 검증

**P0-1: Command Injection 방어**
- 문서 섹션 2.1에 제안된 `sanitize_input()` 함수를 검토하세요
- Opus 주장: 블랙리스트 방식은 우회 가능 (newline injection, Unicode 등)
- 질문: Opus의 지적이 맞습니까? 추가 우회 방법이 있습니까?

**P0-2: Path Traversal 방어**
- 문서 섹션 2.1에 제안된 `validate_output_dir()` 함수를 검토하세요
- Opus 주장: Prefix 매칭은 `/home/user/project-malicious` 같은 경로를 허용
- 질문: Opus의 지적이 맞습니까? 올바른 구현 방법은?

**P0-3: DoS 공격**
- 프롬프트 크기 제한이 없음
- 질문: 악의적 사용자가 10MB 프롬프트를 보내면 어떻게 됩니까?

#### 2. 보안 체크리스트 평가 (섹션 5.3)

문서에 제안된 보안 체크리스트:
```markdown
## 인증 & 인가
- [ ] 인증 메커니즘 구현
- [ ] 권한 검증
...
## 입력 검증
- [ ] SQL Injection 방지
- [ ] XSS 방지
- [ ] Path Traversal 방지
...
```

**질문:**
1. 이 체크리스트가 포괄적입니까?
2. 누락된 보안 항목이 있습니까?
3. Bash 스크립트 특화 보안 항목이 필요합니까?

#### 3. 로그 보안 (Opus가 지적한 P2-3)

**현재 설계:**
- 모든 AI 응답이 `logs/` 디렉토리에 저장됨
- API 키, 프롬프트 내용 모두 로그에 기록

**질문:**
1. 로그에 민감 정보가 노출될 위험은?
2. 로그 파일 권한 설정이 필요합니까?
3. 로그 암호화가 필요합니까?

#### 4. 새로운 취약점 발견

**지시:**
Opus와 설계 문서 모두 놓친 보안 이슈를 찾으세요.

**검토 영역:**
1. **Race Condition**: 동시 실행 시 파일 충돌
2. **Symlink Attack**: 심볼릭 링크 악용
3. **Temp File Security**: mktemp 사용의 안전성
4. **Environment Variables**: 환경 변수 주입 공격
5. **Signal Handling**: SIGINT/SIGTERM 처리 시 cleanup
6. **API Key Exposure**: claude/gemini CLI가 API 키를 어떻게 관리하는가?

#### 5. Defense in Depth 평가

문서는 "Defense in Depth" 원칙을 주장합니다 (섹션 3.2).

**질문:**
1. 실제로 다층 방어가 구현되었습니까?
2. 한 층이 뚫려도 다음 층이 막을 수 있습니까?
3. 추가로 필요한 방어층은?

---

## 출력 형식

다음 파일을 생성하세요:
**`docs/cross-check-auto-v3-gemini-review.md`**

구조:
```markdown
# AI 크로스체크 v3.0 보안 검토 (Gemini)

## 1. 요약
- 보안 등급: [A/B/C/D/F]
- 치명적 취약점: N개
- 주요 우려사항: N개

## 2. Opus P0 이슈 검증

### P0-1: Command Injection 방어
- Opus 주장: [정확함/부정확함]
- 추가 발견: [...]
- 권장 조치: [...]

### P0-2: Path Traversal 방어
- Opus 주장: [정확함/부정확함]
- 추가 발견: [...]
- 권장 조치: [...]

### P0-3: DoS 공격
- 평가: [...]
- 권장 조치: [...]

## 3. 보안 체크리스트 평가
- 포괄성: [충분함/불충분함]
- 누락 항목:
  1. [...]
  2. [...]

## 4. 새롭게 발견된 취약점

### [취약점 1 이름]
- **심각도**: [Critical/High/Medium/Low]
- **공격 시나리오**: [...]
- **영향**: [...]
- **해결 방안**: [...]

[추가 취약점 반복]

## 5. Defense in Depth 평가
- 현재 방어층: [...]
- 누락된 층: [...]
- 권장 강화: [...]

## 6. 종합 의견
- [승인] / [조건부 승인] / [수정 필요]
- 주요 이유:
  1. [...]
  2. [...]

## 7. 우선순위별 조치사항

### 즉시 수정 필요 (P0)
1. [...]
2. [...]

### 우선 수정 (P1)
1. [...]

### 권장 수정 (P2)
1. [...]
```

---

## 보안 검토 원칙

1. **공격자처럼 생각하기**: "이 시스템을 어떻게 해킹할까?"
2. **최악의 시나리오 가정**: "모든 입력이 악의적이라면?"
3. **방어 계층 확인**: "한 방어가 뚫리면?"
4. **실제 공격 사례 참고**: OWASP, CVE 데이터베이스
5. **False Security 경계**: "안전해 보이지만 실제로는?"

---

## 참고 자료

- **설계 문서**: `docs/cross-check-auto-v3-design.md`
- **Opus 리뷰**: `docs/cross-check-auto-v3-opus-review.md` (참고만, 의존 금지)
- **현재 구현**: `scripts/cross_check_auto.sh` (v2.0)
- **Grok 이전 피드백**: (사용자가 제공한 보안 감사 결과)

---

## 중요 알림

**절대 쉽게 승인하지 마세요!**

보안 검토는 엄격해야 합니다. 의심스러우면 반려하세요.
10개 중 9개를 막아도, 1개의 취약점이 시스템 전체를 무너뜨릴 수 있습니다.

---

**검토자**: Gemini 3 Pro Preview
**예상 소요 시간**: 10-15분
**검토 목표**: 공격자가 악용할 수 있는 모든 취약점 발견
